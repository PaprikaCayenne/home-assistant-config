- id: '1733020601130'
  alias: 'Pantry: Motion Detected – Turn On Lights'
  description: Turns on pantry lights when motion is detected
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.pantry_sensor_motion
    to: 'on'
  conditions: []
  actions:
  - action: light.turn_on
    metadata: {}
    data: {}
    target:
      entity_id:
      - light.shellyplus2pm_10061cc9d604_switch_0
      - light.pantry_small_light
  mode: single
- id: '1735003869392'
  alias: 'Bathroom Primary: Motion Detected | Turn On Lights'
  description: Turns on Primary Bathroom lights when motion is detected and automation
    is allowed.
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.bathroom_primary_motion_sensor
    to: 'on'
  conditions:
  - condition: state
    entity_id: binary_sensor.motion_bathroom_primary_allowed
    state: 'on'
  actions:
  - choose:
    - conditions:
      - condition: time
        after: '23:00:00'
        before: 05:00:00
      sequence:
      - action: light.turn_on
        metadata: {}
        data:
          transition: 0.5
          brightness_pct: 100
        target:
          entity_id: light.shellyplus2pm_10061cc9d5d0_switch_1
    - conditions:
      - condition: time
        after: 05:00:00
        before: '23:00:00'
      sequence:
      - data:
          brightness_pct: 100
          transition: 0.5
        target:
          device_id:
          - a3d4249470addab0d5b13b3927049a1f
          entity_id:
          - light.primary_bathroom_bathroom_tub_lights
          - light.primary_bathroom_bathroom_vanity_lights
        action: light.turn_on
  mode: single
- id: '1735010780789'
  alias: 'Bathroom Primary: Motion Not Detected | Turn Off Lights'
  description: Turns off bathroom lights when motion clears and automation is allowed
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.bathroom_primary_motion_sensor
    to: 'off'
  conditions:
  - condition: state
    entity_id: binary_sensor.motion_bathroom_primary_allowed
    state: 'on'
  actions:
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      area_id: bathroom_primary
  mode: single
- id: '1735100274017'
  alias: 'Primary Bathroom: Lights On'
  description: Primary Bathroom on between 5:00 am to 11:00 PM
  triggers:
  - type: occupied
    device_id: 25898c84b016cff177cbab5963036d67
    entity_id: 6ccf18d64b4f0631b8f8a3b1663ad6ba
    domain: binary_sensor
    metadata:
      secondary: false
    trigger: device
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: time
        after: 05:00:00
        before: '23:00:00'
      sequence:
      - action: light.turn_on
        metadata: {}
        data:
          brightness_pct: 100
          transition: 2
        target:
          area_id: bathroom_primary
    - conditions:
      - condition: time
        after: '23:00:00'
        before: 05:00:00
      sequence:
      - action: light.turn_on
        metadata: {}
        data:
          brightness_pct: 1
          transition: 2
        target:
          device_id: 94715ab639717ce9d55b02505fcf19cc
      - action: switch.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: switch.shellyplus2pm_10061cc9d5d0_switch_1
  mode: single
- id: '1737137813584'
  alias: 'Pantry: Motion – Turn Off Lights'
  description: Turns off pantry lights 1 minute after no motion is detected.
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.pantry_sensor_motion
    to: 'off'
    for:
      hours: 0
      minutes: 1
      seconds: 0
  conditions: []
  actions:
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id:
      - light.shellyplus2pm_10061cc9d604_switch_0
      - light.pantry_small_light
  mode: single
- id: '1739152926847'
  alias: 'Misc: Amy has arrived'
  description: ''
  triggers:
  - trigger: zone
    entity_id: person.amy
    zone: zone.home
    event: enter
  conditions: []
  actions:
  - device_id: 414d79e47472f6e2a9779d9e59c30767
    domain: mobile_app
    type: notify
    metadata: {}
    message: Amy has Arrived
  mode: single
- id: '1739152990751'
  alias: 'Misc: Derrek has arrived'
  description: ''
  triggers:
  - trigger: zone
    entity_id: person.derek
    zone: zone.home
    event: enter
  conditions: []
  actions:
  - device_id: 414d79e47472f6e2a9779d9e59c30767
    domain: mobile_app
    type: notify
    metadata: {}
    message: Derrek has arrived
  mode: single
- id: '1739927990971'
  alias: 'Hallway: Motion Detected – Turn On Lights'
  description: Turns on hallway lights with time-based brightness when motion is detected
    and automation is allowed
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.camera_hallway_person
    to: 'on'
  - trigger: state
    entity_id:
    - binary_sensor.hue_motion_sensor_3_motion
    to: 'on'
  - trigger: state
    entity_id:
    - binary_sensor.hue_motion_sensor_5_motion
    to: 'on'
  conditions:
  - condition: state
    entity_id: binary_sensor.motion_hallway_allowed
    state: 'on'
  actions:
  - choose:
    - conditions:
      - condition: time
        after: 06:00:00
        before: 08:00:00
      sequence:
      - data:
          brightness_pct: 40
          transition: 0.5
        target:
          area_id: hallway
        action: light.turn_on
    - conditions:
      - condition: time
        after: '18:00:00'
        before: '23:00:00'
      sequence:
      - data:
          brightness_pct: 100
          transition: 0.5
        target:
          area_id: hallway
        action: light.turn_on
    - conditions:
      - condition: time
        after: 08:00:00
        before: '18:00:00'
      sequence:
      - data:
          brightness_pct: 80
          transition: 0.5
        target:
          area_id: hallway
        action: light.turn_on
    - conditions:
      - condition: time
        after: '23:00:00'
        before: 06:00:00
      sequence:
      - data:
          brightness_pct: 10
          transition: 0.5
        target:
          area_id: hallway
        action: light.turn_on
    enabled: false
  - action: script.hallway_lighting_control_script
    metadata: {}
    data: {}
  mode: single
- id: '1739928051409'
  alias: 'Hallway: Motion Not Detected – Turn Off Lights'
  description: 'Turns off hallway lights after 5–8 minutes of no motion if automation
    is allowed. If manual override is active, delay shutdown by 1 hour.

    '
  triggers:
  - entity_id:
    - binary_sensor.camera_hallway_person
    to: 'off'
    for:
      hours: 0
      minutes: 3
      seconds: 0
    trigger: state
  - entity_id:
    - binary_sensor.hue_motion_sensor_3_motion
    to: 'off'
    for:
      hours: 0
      minutes: 3
      seconds: 0
    trigger: state
  - entity_id:
    - binary_sensor.hue_motion_sensor_5_motion
    to: 'off'
    for:
      hours: 0
      minutes: 3
      seconds: 0
    trigger: state
  conditions:
  - condition: state
    entity_id: binary_sensor.motion_hallway_allowed
    state: 'on'
  actions:
  - target:
      area_id: hallway
    data:
      transition: 0.5
    action: light.turn_off
  mode: single
- id: '1741453716673'
  alias: 'Misc: Primary bathroom fan humidity control'
  description: Controls fan based on humidity and time of day
  triggers:
  - entity_id: sensor.meter_4e38_humidity
    above: 45
    id: humidity_high
    trigger: numeric_state
  - at: '23:01:00'
    id: time_off
    trigger: time
  - at: 05:01:00
    id: time_check
    trigger: time
  - minutes: /5
    id: humidity_poll
    trigger: time_pattern
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: or
        conditions:
        - condition: trigger
          id: humidity_high
        - condition: trigger
          id: humidity_poll
      - condition: time
        after: 05:00:00
        before: '23:00:00'
      - condition: numeric_state
        entity_id: sensor.meter_4e38_humidity
        above: 55
      sequence:
      - target:
          entity_id: fan.shellyplus2pm_10061cc9d5d0_switch_0
        action: fan.turn_on
        data: {}
    - conditions:
      - condition: trigger
        id: time_off
      sequence:
      - target:
          entity_id: fan.shellyplus2pm_10061cc9d5d0_switch_0
        action: fan.turn_off
        data: {}
    - conditions:
      - condition: trigger
        id: time_check
      - condition: numeric_state
        entity_id: sensor.meter_4e38_humidity
        above: 55
      sequence:
      - target:
          entity_id: fan.shellyplus2pm_10061cc9d5d0_switch_0
        action: fan.turn_on
        data: {}
  mode: single
- id: '1741453831029'
  alias: 'Misc: Primary bathroom fan humidity off'
  description: Turns off bathroom fan when humidity drops below 40%
  triggers:
  - entity_id:
    - sensor.meter_4e38_humidity
    below: 40
    trigger: numeric_state
  conditions:
  - condition: state
    entity_id: fan.shellyplus2pm_10061cc9d5d0_switch_0
    state: 'on'
  actions:
  - target:
      entity_id: fan.shellyplus2pm_10061cc9d5d0_switch_0
    action: fan.turn_off
    data: {}
  mode: single
- id: '1741813740720'
  alias: 'Office: Motion Detected – Turn On Lights'
  description: Turns on office lights when motion or occupancy is detected and automation
    is allowed
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.presence_sensor_fp2_whole_office
    to: 'on'
  conditions:
  - condition: state
    entity_id: binary_sensor.motion_office_allowed
    state: 'on'
  actions:
  - action: light.turn_on
    metadata: {}
    data:
      transition: 0.5
      brightness_pct: 100
    target:
      area_id: office
  mode: single
- id: '1741813819294'
  alias: 'Office: Motion Not Detected – Turn Off Lights'
  description: Turns off office lights after inactivity if automation is allowed
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.presence_sensor_fp2_whole_office
    for:
      hours: 0
      minutes: 2
      seconds: 0
    to: 'off'
  conditions:
  - condition: state
    entity_id: binary_sensor.motion_office_allowed
    state: 'on'
  actions:
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      area_id: office
  mode: single
- id: '1742262183606'
  alias: 'Hallway: Pico Remote – Manual Override On'
  description: 'Enables manual override for hallway lights when the Pico "on" button
    is pressed.

    '
  triggers:
  - entity_id: button.unassigned_unnamed_pico_remote_1_on
    trigger: state
  conditions: []
  actions:
  - target:
      entity_id: input_boolean.hallway_lights_manual_override
    action: input_boolean.turn_on
    data: {}
  mode: single
- id: '1742262256554'
  alias: 'Hallway: Pico Remote – Manual Override Off + Suppress Motion'
  description: 'Turns off manual override for hallway lights and temporarily disables
    motion automation for 1 minute to prevent immediate re-triggering.

    '
  triggers:
  - entity_id: button.unassigned_unnamed_pico_remote_1_off
    trigger: state
  conditions: []
  actions:
  - target:
      entity_id: input_boolean.hallway_lights_manual_override
    action: input_boolean.turn_off
    data: {}
  - data:
      stop_actions: true
    target:
      entity_id: automation.hallway_motion_sensed
    action: automation.turn_off
  - delay:
      minutes: 1
  - target:
      entity_id: automation.hallway_motion_sensed
    action: automation.turn_on
    data: {}
  mode: single
- id: '1742362888667'
  alias: 'Hallway: Light Turn On'
  description: Hallway Boolean Turns On Lights
  triggers:
  - trigger: state
    entity_id:
    - input_boolean.hallway_lights_manual_override
    from: 'off'
    to: 'on'
  conditions: []
  actions:
  - action: light.turn_on
    metadata: {}
    data:
      brightness_pct: 100
    target:
      area_id: hallway
  mode: single
- id: '1742362975544'
  alias: 'Hallway: Manual Override Off – Turn Lights Off'
  description: 'Turns off hallway lights when manual override is cleared.

    '
  triggers:
  - entity_id: input_boolean.hallway_lights_manual_override
    from: 'on'
    to: 'off'
    trigger: state
  conditions: []
  actions:
  - target:
      area_id: hallway
    action: light.turn_off
    data: {}
  mode: single
- id: '1742396296105'
  alias: 'Bathroom Guest: Motion Detected | Turn On Lights'
  description: Turns on guest bathroom lights when motion is detected and automation
    is allowed.
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.hue_motion_sensor_bathroom_guest_motion
    to: 'on'
  - trigger: state
    entity_id:
    - binary_sensor.bathroom_guest_motion_sensor
    to: 'on'
  conditions:
  - condition: state
    entity_id: binary_sensor.motion_bathroom_guest_allowed
    state: 'on'
  actions:
  - data:
      transition: 0.5
      brightness_pct: 75
    target:
      area_id: bathroom_guest
    action: light.turn_on
    enabled: false
  - action: script.bathroom_guest_lighting_control_script
    metadata: {}
    data: {}
  mode: single
- id: '1742396391798'
  alias: 'Bathroom Guest: Motion Not Detected | Turn Off Lights'
  description: Turns off Guest Bathroom lights after motion clears and automation
    is allowed.
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.hue_motion_sensor_bathroom_guest_motion
    to: 'off'
    for:
      hours: 0
      minutes: 1
      seconds: 0
  - trigger: state
    entity_id:
    - binary_sensor.bathroom_guest_motion_sensor
    to: 'off'
  conditions:
  - condition: state
    entity_id: binary_sensor.motion_bathroom_guest_allowed
    state: 'on'
  actions:
  - action: light.turn_off
    metadata: {}
    target:
      entity_id:
      - light.bathroom_guest_vanity_lights
    data:
      transition: 0.5
  mode: single
- id: '1742405097534'
  alias: 'Office: Lights Manually Stay On'
  description: Office Lights Boolean to On
  triggers:
  - trigger: state
    entity_id:
    - input_boolean.office_lights_manual_override
    to: 'on'
  conditions: []
  actions:
  - action: light.turn_on
    metadata: {}
    data:
      brightness_pct: 100
    target:
      area_id: office
  mode: single
- id: '1742563148793'
  alias: 'Global: Cleaning Mode – Lights On & Motion Override'
  description: Turns on all lights and disables motion sensors to clean
  triggers:
  - trigger: state
    entity_id:
    - input_boolean.cleaning
    from: 'off'
    to: 'on'
    id: 'On'
  - trigger: state
    entity_id:
    - input_boolean.cleaning
    from: 'on'
    to: 'off'
    id: 'Off'
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - 'On'
      sequence:
      - action: light.turn_on
        metadata: {}
        data:
          color_temp_kelvin: 6500
          brightness_pct: 100
        target:
          area_id:
          - living_room
          - kitchen
          - hallway
          - bedroom_guest
          - bathroom_guest
          - office
          - bedroom_primary
          - bathroom_primary
    - conditions:
      - condition: trigger
        id:
        - 'Off'
      sequence:
      - action: light.turn_off
        metadata: {}
        data:
          transition: 0.5
        target:
          area_id:
          - living_room
          - kitchen
          - hallway
          - bedroom_guest
          - bathroom_guest
          - office
          - bedroom_primary
          - bathroom_primary
  mode: single
- id: '1743211219729'
  alias: 'Office: Manually Turn Off Light'
  description: If the Office Light is Turned Off then Office Boolean set to Off
  triggers:
  - type: turned_off
    device_id: 89e3ce49a9ef408981d0e60f103232fc
    entity_id: 820f53c15c7657430b5b5b1f19634993
    domain: light
    trigger: device
  conditions: []
  actions:
  - action: input_boolean.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.office_lights_manual_override
  - action: light.turn_off
    metadata: {}
    data:
      transition: 0.5
    target:
      area_id: office
  mode: single
- id: '1743455765879'
  alias: 'Leaves: Turn Off All Booleans'
  description: When Colin leaves home, reset manual-on booleans to allow lights to
    turn off.
  triggers:
  - entity_id: person.ha_colin
    zone: zone.home
    event: leave
    trigger: zone
  conditions: []
  actions:
  - target:
      entity_id:
      - input_boolean.bathroom_guest_lights_manual_override
      - input_boolean.hallway_lights_manual_override
      - input_boolean.office_lights_manual_override
      - input_boolean.bedroom_primary_lights_manual_override
      - input_boolean.kitchen_lights_manual_override
      - input_boolean.livingroom_lights_manual_override
    action: input_boolean.turn_off
    data: {}
  mode: single
- id: '1744084082903'
  alias: 'Bedroom Primary: Motion Detected – Turn Lights On [Run Light Control Script]'
  description: Triggers time-based lighting script when motion is detected and automation
    is allowed.
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.camera_bedroom_primary_person
    to: 'on'
  - trigger: state
    entity_id:
    - binary_sensor.hue_motion_sensor_4_motion
    to: 'on'
  conditions:
  - condition: state
    entity_id: binary_sensor.motion_bedroom_primary_allowed
    state: 'on'
  actions:
  - data: {}
    action: script.bedroom_primary_light_control_script
  mode: single
- id: '1744084946434'
  alias: 'Bedroom Primary: Motion Not Detected – Turn Off Lights'
  description: Turns off bedroom lights after motion clears if automation is allowed
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.camera_bedroom_primary_person
    to: 'off'
    for:
      hours: 0
      minutes: 2
      seconds: 0
  - trigger: state
    entity_id:
    - binary_sensor.hue_motion_sensor_4_motion
    to: 'off'
    for:
      hours: 0
      minutes: 2
      seconds: 0
  conditions:
  - condition: state
    entity_id: binary_sensor.motion_bedroom_primary_allowed
    state: 'on'
  actions:
  - data:
      transition: 0.5
    target:
      entity_id: light.bedroom_primary_hue_group_switch
    action: light.turn_off
  mode: restart
- id: '1744085925757'
  alias: 'Bedroom Primary: Button 1 Short Press – Resume Lighting'
  description: 'When the Hue dimmer switch button 1 is short-pressed: - If the bedroom
    lights are off, run the standard light control script. - Always enable the manual
    override to disable motion-based automation.

    '
  triggers:
  - entity_id:
    - event.bedroom_primary_hue_switch_button_1
    to: short_release
    trigger: state
    attribute: event_type
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: state
        entity_id: light.bedroom_primary_hue_group_switch
        state: 'off'
      sequence:
      - action: script.bedroom_primary_light_control_script
        data: {}
  - target:
      entity_id: input_boolean.bedroom_primary_lights_manual_override
    action: input_boolean.turn_on
    data: {}
  mode: single
- id: '1744086157197'
  alias: 'Bedroom Primary: Button 1 Long Press – Full Brightness'
  description: 'When the Hue dimmer switch button 1 is long-pressed and released:
    - Immediately forces the bedroom lights on at full brightness and cool white (6500K)
    - Enables manual override to prevent motion-based shutoff.

    '
  triggers:
  - entity_id:
    - event.bedroom_primary_hue_switch_button_1
    to: long_release
    trigger: state
    attribute: event_type
  conditions: []
  actions:
  - target:
      entity_id: light.bedroom_primary_hue_group_switch
    data:
      color_temp_kelvin: 6500
      brightness_pct: 100
      transition: 1
    action: light.turn_on
  - target:
      entity_id: input_boolean.bedroom_primary_lights_manual_override
    action: input_boolean.turn_on
    data: {}
  mode: single
- id: '1744087421323'
  alias: 'Bedroom Primary: Button 2 Short Press – Dim Up'
  description: 'When the Hue dimmer switch button 2 is short-pressed: - If the bedroom
    lights are on, increase brightness by 20%. - Enable manual override to prevent
    motion-based automation.

    '
  triggers:
  - entity_id:
    - event.bedroom_primary_hue_switch_button_2
    to: short_release
    trigger: state
    attribute: event_type
  conditions: []
  actions:
  - if:
    - condition: state
      entity_id: light.bedroom_primary_hue_group_switch
      state: 'on'
    then:
    - target:
        entity_id: light.bedroom_primary_hue_group_switch
      data:
        brightness_step_pct: 20
      action: light.turn_on
  - target:
      entity_id: input_boolean.bedroom_primary_lights_manual_override
    action: input_boolean.turn_on
    data: {}
  mode: single
- id: '1744087514411'
  alias: 'Bedroom Primary: Button 3 Short Press – Dim Down'
  description: 'When the Hue dimmer switch button 3 is short-pressed: - If the bedroom
    lights are on, decrease brightness by 20%. - Enable manual override to prevent
    motion-based automation.

    '
  triggers:
  - entity_id:
    - event.bedroom_primary_hue_switch_button_3
    to: short_release
    trigger: state
    attribute: event_type
  conditions: []
  actions:
  - if:
    - condition: state
      entity_id: light.bedroom_primary_hue_group_switch
      state: 'on'
    then:
    - target:
        entity_id: light.bedroom_primary_hue_group_switch
      data:
        brightness_step_pct: -20
      action: light.turn_on
  - target:
      entity_id: input_boolean.bedroom_primary_lights_manual_override
    action: input_boolean.turn_on
    data: {}
  mode: single
- id: '1744087961479'
  alias: 'Bedroom Primary: Button 4 Short Press – Power Off'
  description: 'Turns off bedroom lights and resets motion automation after 1 minute.

    '
  triggers:
  - entity_id:
    - event.bedroom_primary_hue_switch_button_4
    to: short_release
    trigger: state
    attribute: event_type
  conditions: []
  actions:
  - target:
      entity_id: light.bedroom_primary_hue_group_switch
    data:
      transition: 0.5
    action: light.turn_off
  - delay:
      minutes: 1
  - target:
      entity_id: input_boolean.bedroom_primary_lights_manual_override
    action: input_boolean.turn_off
    data: {}
  - target:
      entity_id: input_boolean.bedroom_primary_motion_enabled
    action: input_boolean.turn_on
    data: {}
  mode: single
- id: '1744568075505'
  alias: 'Kitchen: Motion Detected – Turn On Lights [Run Light Control Script]'
  description: Turns on kitchen lights when motion is detected and automation is allowed
  triggers:
  - entity_id:
    - binary_sensor.presence_sensor_fp2_whole_downstairs
    to: 'on'
    trigger: state
  conditions:
  - condition: state
    entity_id: binary_sensor.motion_kitchen_allowed
    state: 'on'
  actions:
  - action: script.kitchen_light_control_script
    data: {}
  mode: single
- id: '1744569217413'
  alias: 'Kitchen: Motion Not Detected – Turn Off Lights'
  description: 'Turns off kitchen lights 2 minutes after no motion if automation is
    allowed. If override is active, delays shutoff for 1 hour before checking again.

    '
  triggers:
  - entity_id:
    - binary_sensor.presence_sensor_fp2_whole_downstairs
    to: 'off'
    for:
      minutes: 2
    trigger: state
  conditions:
  - condition: state
    entity_id: binary_sensor.motion_kitchen_allowed
    state: 'on'
  actions:
  - target:
      entity_id:
      - light.kitchen_hue_group_switch
      - light.kitchen_above_cabinet_lightstrip
    data:
      transition: 0.5
    action: light.turn_off
  mode: restart
- id: '1744569877439'
  alias: 'Kitchen: Button 1 Short Press – Enable Manual Override'
  description: 'Enables manual override and disables motion for Kitchen and Livingroom
    unless movie mode is active.

    '
  triggers:
  - entity_id:
    - event.kitchen_hue_switch_button_1
    to: short_release
    trigger: state
    attribute: event_type
  conditions:
  - condition: state
    entity_id: input_boolean.movie
    state: 'off'
  actions:
  - action: script.downstairs_enable_manual_override
    metadata: {}
    data: {}
  mode: single
- id: '1744569919431'
  alias: 'Kitchen: Button 2 Short Press – Brighten & Override'
  description: 'Increases Kitchen light brightness by 20% and enables manual override
    for both rooms.

    '
  triggers:
  - entity_id:
    - event.kitchen_hue_switch_button_2
    to: short_release
    trigger: state
    attribute: event_type
  conditions: []
  actions:
  - target:
      entity_id: light.kitchen_hue_group_switch
    data:
      brightness_step_pct: 20
    action: light.turn_on
  - target:
      entity_id:
      - input_boolean.kitchen_lights_manual_override
      - input_boolean.livingroom_lights_manual_override
    action: input_boolean.turn_on
    data: {}
  mode: single
- id: '1744569937922'
  alias: 'Kitchen: Button 2 Long Press – Brighten Both & Override'
  description: 'Sets Kitchen and Livingroom lights to 100% brightness at 3500K and
    enables manual override.

    '
  triggers:
  - entity_id:
    - event.kitchen_hue_switch_button_2
    to: long_press
    trigger: state
    attribute: event_type
  conditions: []
  actions:
  - target:
      entity_id:
      - light.kitchen_hue_group_switch
      - light.livingroom_hue_group_switch
    data:
      brightness_pct: 100
      color_temp_kelvin: 3500
      transition: 0.5
    action: light.turn_on
  - target:
      entity_id:
      - input_boolean.kitchen_lights_manual_override
      - input_boolean.livingroom_lights_manual_override
    action: input_boolean.turn_on
    data: {}
  mode: single
- id: '1744570439455'
  alias: 'Kitchen: Button 3 Short Press – Dim Kitchen & Override'
  description: Dims kitchen lights by 20% and enables override for both rooms.
  triggers:
  - trigger: state
    entity_id:
    - event.kitchen_hue_switch_button_3
    attribute: event_type
    to: short_release
  actions:
  - target:
      entity_id: light.kitchen_hue_group_switch
    data:
      brightness_step_pct: -20
    action: light.turn_on
  - action: input_boolean.turn_on
    metadata: {}
    data: {}
    target:
      entity_id:
      - input_boolean.kitchen_lights_manual_override
      - input_boolean.livingroom_lights_manual_override
  mode: single
- id: '1744570457351'
  alias: 'Kitchen: Button 3 Long Press – Dim Both & Override'
  description: 'Dims Kitchen and Livingroom lights by 20% and enables manual override
    for both rooms.

    '
  triggers:
  - entity_id:
    - event.kitchen_hue_switch_button_3
    to: long_release
    trigger: state
    attribute: event_type
  conditions: []
  actions:
  - target:
      entity_id:
      - light.kitchen_hue_group_switch
      - light.livingroom_hue_group_switch
    data:
      brightness_step_pct: -20
    action: light.turn_on
  - target:
      entity_id:
      - input_boolean.kitchen_lights_manual_override
      - input_boolean.livingroom_lights_manual_override
    action: input_boolean.turn_on
    data: {}
  mode: single
- id: '1744570486701'
  alias: 'Kitchen: Button 2 Short Press – Dim Down'
  description: 'Decreases Kitchen light brightness by 20% if lights are on. Enables
    manual override to prevent motion-based automation.

    '
  triggers:
  - entity_id:
    - event.kitchen_hue_switch_button_2
    to: short_release
    trigger: state
    attribute: event_type
  conditions: []
  actions:
  - if:
    - condition: state
      entity_id: light.kitchen_hue_group_switch
      state: 'on'
    then:
    - target:
        entity_id: light.kitchen_hue_group_switch
      data:
        brightness_step_pct: -20
      action: light.turn_on
  - target:
      entity_id: input_boolean.kitchen_lights_manual_override
    action: input_boolean.turn_on
    data: {}
  mode: single
- id: '1744570504251'
  alias: 'Kitchen: Button 4 Long Press – Turn Off Both, Restore Motion'
  description: 'Turns off Kitchen and Livingroom lights, then calls reset script to
    clear overrides and re-enable motion after 30 seconds.

    '
  triggers:
  - entity_id:
    - event.kitchen_hue_switch_button_4
    to: long_release
    trigger: state
    attribute: event_type
  conditions: []
  actions:
  - target:
      entity_id:
      - light.kitchen_hue_group_switch
      - light.livingroom_hue_group_switch
      - light.kitchen_above_cabinet_lightstrip
      - light.livingroom_couch_lightstrip
    data:
      transition: 0.5
    action: light.turn_off
  - delay:
      seconds: 30
  - action: script.reset_kitchen_livingroom_motion
    data: {}
  mode: single
- id: '1744572277100'
  alias: 'Livingroom: Button 1 Short Press – Enable Manual Override'
  description: 'Enables manual override and disables motion for Kitchen and Livingroom
    unless movie mode is active.

    '
  triggers:
  - entity_id:
    - event.livingroom_hue_switch_button_1
    to: short_release
    trigger: state
    attribute: event_type
  conditions:
  - condition: state
    entity_id: input_boolean.movie
    state: 'off'
  actions:
  - action: script.downstairs_enable_manual_override
    metadata: {}
    data: {}
  mode: single
- id: '1744572350355'
  alias: 'Livingroom: Button 2 Short Press – Brighten & Override'
  description: 'Increases Livingroom light brightness by 20% and enables manual override
    to prevent motion automation in both rooms.

    '
  triggers:
  - entity_id:
    - event.livingroom_hue_switch_button_2
    to: short_release
    trigger: state
    attribute: event_type
  conditions: []
  actions:
  - target:
      entity_id: light.livingroom_hue_group_switch
    data:
      brightness_step_pct: 20
    action: light.turn_on
  - target:
      entity_id:
      - input_boolean.kitchen_lights_manual_override
      - input_boolean.livingroom_lights_manual_override
    action: input_boolean.turn_on
    data: {}
  mode: single
- id: '1744572370241'
  alias: 'Livingroom: Button 2 Long Press – Brighten Both & Override'
  description: 'Sets Kitchen and Livingroom lights to 100% brightness at 3500K and
    enables manual override to prevent motion shutoff.

    '
  triggers:
  - entity_id:
    - event.livingroom_hue_switch_button_2
    to: long_press
    trigger: state
    attribute: event_type
  conditions: []
  actions:
  - target:
      entity_id:
      - light.kitchen_hue_group_switch
      - light.livingroom_hue_group_switch
    data:
      brightness_pct: 100
      color_temp_kelvin: 3500
      transition: 0.5
    action: light.turn_on
  - target:
      entity_id:
      - input_boolean.kitchen_lights_manual_override
      - input_boolean.livingroom_lights_manual_override
    action: input_boolean.turn_on
    data: {}
  mode: single
- id: '1744572385925'
  alias: 'Livingroom: Button 3 Short Press – Dim & Override'
  description: 'Decreases Livingroom light brightness by 20% and enables manual override
    to prevent motion-based shutoff in both rooms.

    '
  triggers:
  - entity_id:
    - event.livingroom_hue_switch_button_3
    to: short_release
    trigger: state
    attribute: event_type
  conditions: []
  actions:
  - target:
      entity_id: light.livingroom_hue_group_switch
    data:
      brightness_step_pct: -20
    action: light.turn_on
  - target:
      entity_id:
      - input_boolean.kitchen_lights_manual_override
      - input_boolean.livingroom_lights_manual_override
    action: input_boolean.turn_on
    data: {}
  mode: single
- id: '1744572402585'
  alias: 'Livingroom: Button 3 Long Press – Dim Both & Override'
  description: 'Dims Kitchen and Livingroom lights by 20% and enables manual override
    to prevent motion-based automation.

    '
  triggers:
  - entity_id:
    - event.livingroom_hue_switch_button_3
    to: long_press
    trigger: state
    attribute: event_type
  conditions: []
  actions:
  - target:
      entity_id:
      - light.kitchen_hue_group_switch
      - light.livingroom_hue_group_switch
    data:
      brightness_step_pct: -20
    action: light.turn_on
  - target:
      entity_id:
      - input_boolean.kitchen_lights_manual_override
      - input_boolean.livingroom_lights_manual_override
    action: input_boolean.turn_on
    data: {}
  mode: single
- id: '1744572419902'
  alias: 'Kitchen: Button 4 Short Press – Area Off & Reset Motion'
  description: 'Turns off Livingroom lights, then calls reset script to clear Kitchen
    and Livingroom overrides and re-enable motion automation after 30 seconds.

    '
  triggers:
  - entity_id:
    - event.kitchen_hue_switch_button_4
    to: short_release
    trigger: state
    attribute: event_type
  conditions: []
  actions:
  - data:
      transition: 0.5
    action: light.turn_off
    target:
      entity_id:
      - light.kitchen_hue_group_switch
      - light.kitchen_above_cabinet_lightstrip
  - delay:
      seconds: 30
  - action: script.reset_kitchen_livingroom_motion
    data: {}
  mode: single
- id: '1744572436937'
  alias: 'Livingroom: Button 4 Long Press – All Off & Reset Motion'
  description: 'Turns off Kitchen and Livingroom lights, then calls reset script to
    clear overrides and re-enable motion automation after 30 seconds.

    '
  triggers:
  - entity_id:
    - event.livingroom_hue_switch_button_4
    to: long_release
    trigger: state
    attribute: event_type
  conditions: []
  actions:
  - target:
      entity_id:
      - light.kitchen_hue_group_switch
      - light.livingroom_hue_group_switch
      - light.kitchen_above_cabinet_lightstrip
      - light.livingroom_couch_lightstrip
    data:
      transition: 0.5
    action: light.turn_off
  - delay:
      seconds: 30
  - action: script.reset_kitchen_livingroom_motion
    data: {}
  mode: single
- id: '1744601049270'
  alias: 'Git: Nightly Backup Push'
  description: Commits and pushes current config every night at 2:00 AM
  triggers:
  - at: 02:00:00
    trigger: time
  actions:
  - action: shell_command.nightly_git_backup
  mode: single
- id: '1745955843300'
  alias: 'Global: Reset Overrides & Turn Off Lights at 03:00 AM'
  description: Run reset scripts and shut down all room lighting
  triggers:
  - at: 03:00:00
    trigger: time
  conditions: []
  actions:
  - action: script.global_reset_manual_overrides_off
    data: {}
  - action: script.global_enable_motion_automation
    data: {}
  - target:
      area_id:
      - bathroom_primary
      - bedroom_guest
      - bathroom_guest
      - hallway
      - kitchen
      - living_room
      - office
      - stairs
    data:
      transition: 0.5
    action: light.turn_off
  mode: single
- id: '1745956186858'
  alias: 'Office: Motion Detected – Hold Lights On (8 AM–5 PM)'
  description: Keeps office lights on during business hours when motion or occupancy
    is detected and automation is allowed
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.camera_office_person
    to: 'on'
  - trigger: state
    entity_id:
    - binary_sensor.office_occupancy
    to: 'on'
  conditions:
  - condition: time
    after: 08:00:00
    before: '17:00:00'
  - condition: state
    entity_id: binary_sensor.motion_office_allowed
    state: 'on'
  actions:
  - action: input_boolean.turn_on
    data: {}
    target:
      entity_id: input_boolean.office_lights_manual_override
  - action: light.turn_on
    target:
      area_id: office
    data:
      brightness_pct: 100
      transition: 0.5
  mode: single
- id: '1745956245665'
  alias: 'Office: End Hold at 5 PM'
  description: ''
  triggers:
  - at: '17:00:00'
    trigger: time
  actions:
  - action: input_boolean.turn_off
    data: {}
    target:
      entity_id: input_boolean.office_lights_manual_override
  - if:
    - type: is_off
      condition: device
      device_id: 070678fd4c81abfab4b665d811c821ef
      entity_id: 5e9ca6fdfe7d99393b1945bbcdaa831d
      domain: binary_sensor
    - type: is_not_occupied
      condition: device
      device_id: 8e65b7c2b32be2115e4e11f153e3d21a
      entity_id: 4c10a2c0670f659b32df3abed8ac7d3f
      domain: binary_sensor
    then:
    - target:
        area_id: office
      data:
        transition: 1
      action: light.turn_off
  mode: single
- id: '1746206656134'
  alias: 'Bathroom Guest: Manually Stay On'
  description: Guest Bathroom Boolean to On and turn on lights to keep them on
  triggers:
  - trigger: state
    entity_id:
    - input_boolean.bathroom_guest_lights_manual_override
    from: 'off'
    to: 'on'
  conditions: []
  actions:
  - action: light.turn_on
    metadata: {}
    data:
      brightness_pct: 100
    target:
      area_id: bathroom_guest
  mode: single
- id: '1749509387699'
  alias: 'Livingroom: Movie Mode – Activate Scene Only'
  description: 'Activates the movie scene when movie mode is turned on. No longer
    disables motion — FP2 handles presence natively.

    '
  triggers:
  - entity_id: input_boolean.movie
    to: 'on'
    trigger: state
  conditions: []
  actions:
  - target:
      entity_id: scene.downstairs_inside_movie_tokyo
    action: scene.turn_on
    data: {}
  mode: single
- id: '1749747243302'
  alias: 'Hallway: Reset Motion Streak Count'
  description: 'Resets the hallway motion streak counter if no motion is detected
    within the 5-minute window.

    '
  triggers:
  - event_type: timer.finished
    event_data:
      entity_id: timer.hallway_motion_streak_window
    trigger: event
  conditions: []
  actions:
  - target:
      entity_id: counter.hallway_motion_streak_count
    action: counter.reset
    data: {}
  mode: single
- id: '1749854379022'
  alias: 'Kitchen: Button 1 Long Press – Activate Concentrate Mode'
  description: 'Activates Concentrate Mode across Kitchen and Livingroom, disables
    motion, enables manual override, and exits Movie Mode.

    '
  triggers:
  - entity_id:
    - event.kitchen_hue_switch_button_1
    to: long_release
    trigger: state
    attribute: event_type
  conditions: []
  actions:
  - action: script.downstairs_activate_concentrate_mode
    metadata: {}
    data: {}
  - action: input_boolean.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.movie_mode
  mode: single
- id: '1749854614158'
  alias: 'Livingroom: Button 1 Long Press – Activate Concentrate Mode'
  description: 'Activates Concentrate Mode across Kitchen and Livingroom, disables
    motion, enables manual override, and exits Movie Mode.

    '
  triggers:
  - entity_id:
    - event.livingroom_hue_switch_button_1
    to: long_release
    trigger: state
    attribute: event_type
  conditions: []
  actions:
  - action: script.downstairs_activate_concentrate_mode
    metadata: {}
    data: {}
  - action: input_boolean.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.movie_mode
  mode: single
- id: '1749875600345'
  alias: 'Movie Mode: Auto Reset After TV Off'
  description: 'If the Livingroom TV is turned off and movie mode is still active,
    waits 5 minutes and then disables movie mode. This allows FP2 presence to take
    back control. Includes a persistent notification for visibility.

    '
  triggers:
  - entity_id: media_player.livingroom_tv
    to: 'off'
    trigger: state
  conditions:
  - condition: state
    entity_id: input_boolean.movie
    state: 'on'
  actions:
  - delay: 00:05:00
  - condition: state
    entity_id: input_boolean.movie
    state: 'on'
  - target:
      entity_id: input_boolean.movie
    action: input_boolean.turn_off
    data: {}
  - data:
      title: Movie Mode Auto Reset
      message: 'Movie mode was automatically turned off 5 minutes after the Livingroom
        TV was turned off.

        '
    action: persistent_notification.create
  - condition: state
    entity_id: input_boolean.kitchen_lights_manual_override
    state: 'on'
  - action: input_boolean.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.kitchen_lights_manual_override
  - condition: state
    entity_id: input_boolean.livingroom_lights_manual_override
    state: 'on'
  - action: input_boolean.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.livingroom_lights_manual_override
  mode: restart
- id: '1749876129118'
  alias: 'Movie Mode: Smooth Kitchen Brighten on Presence'
  description: 'While movie mode is active, brightens kitchen lights by 20% when FP2
    detects presence in the cooking area. Fades them back down by 20% when presence
    is gone.

    '
  triggers:
  - entity_id:
    - binary_sensor.presence_sensor_fp2_cooking_area
    trigger: state
  conditions:
  - condition: state
    entity_id: input_boolean.movie
    state: 'on'
  actions:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.presence_sensor_fp2_cooking_area
        state: 'on'
      sequence:
      - target:
          entity_id: light.kitchen_hue_group_switch
        data:
          brightness_step_pct: 50
          transition: 1
        action: light.turn_on
    - conditions:
      - condition: state
        entity_id: binary_sensor.presence_sensor_fp2_cooking_area
        state: 'off'
      sequence:
      - target:
          entity_id: light.kitchen_hue_group_switch
        data:
          transition: 1
          brightness_pct: 1
        action: light.turn_on
  mode: restart
- id: '1749879690322'
  alias: 'Bedroom Primary: Dial Switch Button 1 Short Press – Resume Lighting'
  description: 'When the Hue dimmer switch button 1 is short-pressed: - If the bedroom
    lights are off, run the standard light control script. - Always enable the manual
    override to disable motion-based automation.

    '
  triggers:
  - entity_id:
    - event.hue_tap_dial_switch_bedroom_primary_button_1
    to: short_release
    trigger: state
    attribute: event_type
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: state
        entity_id: light.bedroom_primary_hue_group_switch
        state: 'off'
      sequence:
      - action: script.bedroom_primary_light_control_script
        data: {}
  - target:
      entity_id: input_boolean.bedroom_primary_lights_manual_override
    action: input_boolean.turn_on
    data: {}
  mode: single
- id: '1749879901338'
  alias: 'Bedroom Primary: Dial Switch Button 4 Short Press – Power Off'
  description: 'Turns off bedroom lights and resets motion automation after 1 minute.

    '
  triggers:
  - entity_id:
    - event.hue_tap_dial_switch_bedroom_primary_button_4
    to: short_release
    trigger: state
    attribute: event_type
  conditions: []
  actions:
  - target:
      entity_id: light.bedroom_primary_hue_group_switch
    data:
      transition: 0.5
    action: light.turn_off
  - delay:
      minutes: 1
  - target:
      entity_id: input_boolean.bedroom_primary_lights_manual_override
    action: input_boolean.turn_off
    data: {}
  - target:
      entity_id: input_boolean.bedroom_primary_motion_enabled
    action: input_boolean.turn_on
    data: {}
  mode: single
- id: '1749909190648'
  alias: 'Livingroom: Motion Detected – Turn On Lights [Run Light Control Script]'
  description: Turns on livingroom lights when motion is detected and automation is
    allowed
  triggers:
  - entity_id:
    - binary_sensor.presence_sensor_fp2_whole_downstairs
    to: 'on'
    trigger: state
  conditions:
  - condition: state
    entity_id: binary_sensor.motion_livingroom_allowed
    state: 'on'
  actions:
  - action: script.livingroom_light_control_script
    data: {}
  mode: single
- id: '1749922951079'
  alias: 'Livingroom: Motion Not Detected – Turn Off Lights'
  description: 'Turns off kitchen lights 2 minutes after no motion if automation is
    allowed. If override is active, delays shutoff for 1 hour before checking again.

    '
  triggers:
  - entity_id:
    - binary_sensor.presence_sensor_fp2_whole_downstairs
    to: 'off'
    for:
      minutes: 2
    trigger: state
  conditions:
  - condition: state
    entity_id: binary_sensor.motion_livingroom_allowed
    state: 'on'
  actions:
  - target:
      entity_id:
      - light.livingroom_hue_group_switch
      - light.livingroom_couch_lightstrip
    data:
      transition: 0.5
    action: light.turn_off
  mode: restart
- id: '1749924397237'
  alias: 'Stairs: Motion Detected – Turn On Lights'
  description: Turns on Stairs lights when motion is detected and automation is allowed
  triggers:
  - entity_id:
    - binary_sensor.hue_motion_sensor_5_motion
    to: 'on'
    trigger: state
  conditions:
  - condition: state
    entity_id: binary_sensor.motion_stairs_allowed
    state: 'on'
  actions:
  - action: script.stairway_lighting_control_script
    metadata: {}
    data: {}
  mode: single
- id: '1749924454709'
  alias: 'Stairs: Not Motion Detected – Turn Off Lights'
  description: Turns off Stairs lights when motion is not detected and automation
    is allowed
  triggers:
  - entity_id:
    - binary_sensor.hue_motion_sensor_5_motion
    to: 'off'
    trigger: state
    for:
      hours: 0
      minutes: 1
      seconds: 0
  conditions:
  - condition: state
    entity_id: binary_sensor.motion_stairs_allowed
    state: 'on'
  actions:
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: light.stairs_downstairs_switch
  mode: single
- id: '1753320650160'
  alias: 'Livongroom: Button 4 Short Press – Area Off & Reset Motion'
  description: 'Turns off Livingroom lights, then calls reset script to clear Kitchen
    and Livingroom overrides and re-enable motion automation after 30 seconds.

    '
  triggers:
  - entity_id:
    - event.hue_tap_dial_switch_livingroom_button_4
    to: short_release
    trigger: state
    attribute: event_type
  conditions: []
  actions:
  - data:
      transition: 0.5
    action: light.turn_off
    target:
      entity_id:
      - light.livingroom_hue_group_switch
      - light.livingroom_couch_lightstrip
  - delay:
      seconds: 30
  - action: script.reset_kitchen_livingroom_motion
    data: {}
  mode: single
- id: '1753475079383'
  alias: 'Bedroom Guest: Motion Detected – Turn On Lights'
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.office_motion
    to: 'on'
  conditions: []
  actions:
  - action: light.turn_on
    metadata: {}
    data:
      brightness_pct: 100
      transition: 0.5
    target:
      entity_id:
      - light.bedroom_guest_main_lights
  mode: single
- id: '1753475189498'
  alias: 'Bedroom Guest: Motion Not Detected – Turn Off Lights'
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.office_motion
    to: 'off'
    for:
      hours: 0
      minutes: 2
      seconds: 0
  conditions: []
  actions:
  - action: light.turn_off
    metadata: {}
    data:
      transition: 0.5
    target:
      entity_id:
      - light.bedroom_guest_main_lights
  mode: single
